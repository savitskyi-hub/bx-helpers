BX.namespace("SavitskyiHub.BxHelpers.Helpers.Content.Popup");(function(){BX.SavitskyiHub.BxHelpers.Helpers.Content.Popup={init:function(){BX.bindDelegate(HTML,"click",{attribute:"data-fancy-helpers"},BX.delegate(function(e){var obData=e.toElement.dataset,popup;if(undefined!=obData.fancyHelpers&&null==(popup=BX(obData.fancyHelpers))){this.startLoader();setTimeout(BX.delegate(function(response){this.get(obData);this.finishLoader()},this),100)}else{this.show(popup,obData.fancyHelpersAfterShow,obData.fancyHelpersBeforeShow)}},this))},get:function(prop){BX.ajax({url:"/bitrix/services/main/ajax.php?mode=class&c=savitskyi.helpers:content.ajax&action=controller",data:{SITE_ID:BX.SavitskyiHub.BxHelpers.Helpers.Option.SITE_ID,sessid:BX.bitrix_sessid(),post:{templateName:"popup."+prop.fancyHelpers,logicMode:"get",prop:prop}},method:"POST",dataType:"json",async:false,onsuccess:BX.delegate(function(response){if("success"===response.status){if(response.data.content){var doc,popup,popupsBlock;doc=new DOMParser().parseFromString(response.data.content,"text/html");popup=BX.findChild(doc,{attribute:{id:prop.fancyHelpers}},true);popupsBlock=BX.findChild(HTML,{attribute:{"data-content":"POPUPS"}},true);popupsBlock.appendChild(popup);this.show(popup,prop.fancyHelpersAfterShow,prop.fancyHelpersBeforeShow)}}else{console.error(response.errors)}},this)})},show:function(content,afterShowInit,beforeShowInit){$.fancybox.open(content,{animationEffect:"fade",autoFocus:false,trapFocus:false,touch:false,baseTpl:'<div class="fancybox-container"><div class="fancybox-bg"></div><div class="fancybox-inner"><div class="fancybox-stage"></div></div></div>',btnTpl:{smallBtn:'<button class="fancybox-close" data-fancybox-close><div class="icon g-close-fancy"></div></button>'},beforeShow:function(){if(undefined!=beforeShowInit){eval(beforeShowInit)}if("function"===typeof(helpersBeforeShowPopup)){helpersBeforeShowPopup()}},afterShow:function(){if(undefined!=afterShowInit){eval(afterShowInit)}if("function"===typeof(helpersAfterShowPopup)){helpersAfterShowPopup()}}})},getLoader:function(){return BX.findChild(BX("bx-html"),{className:"helpers-fancy-loader-screen"},true)},startLoader:function(){var loader=this.getLoader();new BX.easing({duration:150,start:{opacity:0},finish:{opacity:87},step:function(state){loader.style.opacity=state.opacity/100;loader.style.display="block"}}).animate()},finishLoader:function(){var loader=this.getLoader();new BX.easing({duration:450,start:{opacity:87},finish:{opacity:0},step:function(state){loader.style.opacity=state.opacity/100},complete:function(){loader.style.display="none"}}).animate()},obHelpers:{setTitle:function(message){var thisTitle=BX.findChild(BX(this.namespace),{className:"helpers-fancy-title"},true);if(null!=thisTitle){if(undefined==thisTitle.dataset.helpersStopReplaceTitle){thisTitle.textContent=message}}},setTitleLikeStyle:function(){var thisTitle=BX.findChild(BX(this.namespace),{className:"helpers-fancy-title"},true);if(null!=thisTitle){BX.addClass(thisTitle,"like")}},setContent:function(content){var thisContent=BX.findChild(BX(this.namespace),{className:"helpers-fancy-content"},true);if(null!=thisContent){thisContent.innerHTML=content}},showError:function(message){var errorNode=BX.findChild(BX(this.namespace),{className:"helpers-form-error"},true);if(null!=errorNode){errorNode.textContent=message}},cleanError:function(){var errorNode=BX.findChild(BX(this.namespace),{className:"helpers-form-error"},true);if(null!=errorNode){errorNode.textContent=""}},refreshCaptcha:function(){var oldCaptcha=BX.findChild(BX(this.namespace),{className:"helpers-form-captcha"},true);if(null!=oldCaptcha){BX.SavitskyiHub.BxHelpers.Helpers.Content.Base.refreshCaptcha(oldCaptcha)}},updateGlobalEvents:function(){}}}})();